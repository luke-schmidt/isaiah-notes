% Isaiah Bible Study Style Package
% Created for Bible study formatting with specialized environments and highlighting

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{isaiah}[2025/01/01 Isaiah Bible Study Style Package]

% Required packages
\RequirePackage{xcolor}
\RequirePackage{tikz}
\usetikzlibrary{shadows}
\RequirePackage{enumitem}
\RequirePackage{calc}
\RequirePackage{mdframed}

% Define colors
\definecolor{sectionbg}{gray}{0.9}
\definecolor{bordercolor}{gray}{0.3}
\definecolor{highlightred}{RGB}{220, 20, 60}
\definecolor{highlightpurple}{RGB}{128, 0, 128}
\definecolor{highlightgray}{RGB}{128, 128, 128}
\definecolor{highlightbrown}{RGB}{139, 69, 19}
\definecolor{highlightgreen}{RGB}{34, 139, 34}
\definecolor{lightgreenbg}{RGB}{220, 255, 220}
\definecolor{lightredbg}{RGB}{255, 220, 220}
\definecolor{lightbrownbg}{RGB}{255, 235, 205}
\definecolor{boldred}{RGB}{180, 30, 50}
\definecolor{highlightblue}{RGB}{25, 25, 139}
\definecolor{lightbluebg}{RGB}{220, 235, 255}
\definecolor{highlightsilvertext}{RGB}{64, 64, 64}
\definecolor{lightsilverbg}{RGB}{240, 240, 240}
\definecolor{highlightpurpletext}{RGB}{128, 0, 128}
\definecolor{lightpurplebg}{RGB}{245, 220, 255}
\definecolor{highlightorangetext}{RGB}{204, 85, 0}
\definecolor{lightorangebg}{RGB}{255, 235, 205}
\definecolor{highlightyellowtext}{RGB}{153, 153, 0}
\definecolor{lightyellowbg}{RGB}{255, 255, 180}
\definecolor{highlightaquatext}{RGB}{0, 128, 128}
\definecolor{lightaquabg}{RGB}{224, 255, 255}

% Command for the main section with border and optional header
\newenvironment{biblicaloutline}[1][]{%
    \par\vspace{15pt}%
    \def\bibheader{#1}%
    % Create the bordered content box with optional header overlay
    \begin{tikzpicture}[baseline=(current bounding box.north)]
    \node[
        draw=bordercolor,
        line width=1.5pt,
        rounded corners=10pt,
        inner sep=15pt,
        text width=\linewidth-30pt,
        anchor=north west
    ] (box) at (0,0) \bgroup
    \begin{minipage}{\linewidth-30pt}
    \vspace{1pt}
}{%
    \vspace{10pt}
    \end{minipage}
    \egroup;
    % If header is provided, overlay it on the border
    \ifx\bibheader\empty
        % No header provided
    \else
        \node[fill=white, anchor=west] at ([xshift=20pt]box.north west) {\Large\bfseries\,\bibheader\,};
    \fi
    \end{tikzpicture}
    \par\vspace{10pt}%
}

% Command for subsection headers with line
\newcommand{\subsectionheader}[1]{%
    \vspace{10pt}%
    \noindent\textbf{#1}\\[-6pt]
    \noindent\rule{\widthof{\textbf{#1}}}{0.5pt}%
    \vspace{4pt}%
}

% Environment for verse sections with optional left marker and built-in poetry
\newenvironment{versesection}[2][]{%
    \par\noindent%
    \begin{minipage}[c]{0.08\linewidth}
        \ifx&#1&%
            % No marker
        \else
            \centering\textbf{\large #1}
        \fi
    \end{minipage}%
    \begin{minipage}[c]{0.92\linewidth}
    \begin{list}{}{%
        \setlength{\leftmargin}{0pt}%
        \setlength{\rightmargin}{0pt}%
        \setlength{\listparindent}{0pt}%
        \setlength{\itemindent}{0pt}%
        \setlength{\parsep}{0pt}%
        \setlength{\topsep}{0pt}%
        \setlength{\itemsep}{0pt}%
    }%
    \item[]%
    \def\poetryindent{#2}%
    \ifx&#2&\def\poetryindent{2em}\fi% Default to 2em if not specified
    \obeylines%
    % Define alternating indent commands
    \newcommand{\poetryline}{\hspace*{\poetryindent}}%
}{%
    \end{list}%
    \end{minipage}%
    \par\vspace{8pt}%
}

% Custom verse numbering command
\newcommand{\versenum}[1]{\vspace{3pt}\textsuperscript{#1}}

% Custom indentation environment for subsections
\newenvironment{indentedsubsection}[1][20pt]{%
    \begin{list}{}{%
        \setlength{\leftmargin}{#1}%
        \setlength{\rightmargin}{0pt}%
        \setlength{\listparindent}{0pt}%
        \setlength{\itemindent}{0pt}%
        \setlength{\parsep}{0pt}%
        \setlength{\topsep}{0pt}%
    }%
    \item[]%
}{%
    \end{list}%
}

% Chiastic structure environment with automatic indentation levels (page-breakable)
\newenvironment{chiasticoutline}[3][]{%
    \par\vspace{15pt}%
    \def\bibheader{#1}%
    \def\chiasticindent{#2}% Base indentation unit (e.g., 1em)
    \def\poetryindentunit{#3}% Poetry line indentation (e.g., 2em)
    % Create the mdframed environment with optional header
    \ifx\bibheader\empty
        \begin{mdframed}[
            linewidth=1.5pt,
            linecolor=bordercolor,
            roundcorner=10pt,
            tikzsetting={rounded corners=10pt},
            innerleftmargin=15pt,
            innerrightmargin=15pt,
            innertopmargin=15pt,
            innerbottommargin=15pt
        ]
    \else
        \begin{mdframed}[
            linewidth=1.5pt,
            linecolor=bordercolor,
            roundcorner=10pt,
            tikzsetting={rounded corners=10pt},
            innerleftmargin=15pt,
            innerrightmargin=15pt,
            innertopmargin=15pt,
            innerbottommargin=15pt,
            frametitle={\Large\bfseries\,\bibheader\,},
            frametitleaboveskip=10pt,
            frametitlealignment=\raggedright
        ]
    \fi
    % Define chiastic versesection command
    % Usage: \chiasticverse[marker]{level}{content} or \chiasticverselabel[marker]{level}{content}{sublabel}
    \newcommand{\chiasticverse}[3][]{%
        % ##1 = marker, ##2 = level (A=0, B=1, C=2, etc.), ##3 = content
        \par\noindent%
        \hspace*{##2\chiasticindent}%
        \begin{minipage}[c]{0.08\linewidth}
            \ifx&##1&%
                % No marker
            \else
                \centering\textbf{\large ##1}%
            \fi
        \end{minipage}%
        \begin{minipage}[c]{\dimexpr0.92\linewidth-##2\chiasticindent\relax}
        \begin{list}{}{%
            \setlength{\leftmargin}{0pt}%
            \setlength{\rightmargin}{0pt}%
            \setlength{\listparindent}{0pt}%
            \setlength{\itemindent}{0pt}%
            \setlength{\parsep}{0pt}%
            \setlength{\topsep}{0pt}%
            \setlength{\itemsep}{0pt}%
        }%
        \item[]%
        \obeylines%
        \newcommand{\poetryline}{\hspace*{\poetryindentunit}}%
        ##3%
        \end{list}%
        \end{minipage}%
        \par\vspace{8pt}%
    }%
    % Define chiastic versesection command with sublabel
    % Usage: \chiasticverselabel[marker]{level}{content}{sublabel}
    \newcommand{\chiasticverselabel}[4][]{%
        % ##1 = marker, ##2 = level (A=0, B=1, C=2, etc.), ##3 = content, ##4 = sublabel
        \par\noindent%
        \hspace*{##2\chiasticindent}%
        \begin{minipage}[c]{0.08\linewidth}
            \ifx&##1&%
                % No marker
            \else
                \centering\textbf{\large ##1}%
                \\[2pt]\centering\textit{\small ##4}%
            \fi
        \end{minipage}%
        \begin{minipage}[c]{\dimexpr0.92\linewidth-##2\chiasticindent\relax}
        \begin{list}{}{%
            \setlength{\leftmargin}{0pt}%
            \setlength{\rightmargin}{0pt}%
            \setlength{\listparindent}{0pt}%
            \setlength{\itemindent}{0pt}%
            \setlength{\parsep}{0pt}%
            \setlength{\topsep}{0pt}%
            \setlength{\itemsep}{0pt}%
        }%
        \item[]%
        \obeylines%
        \newcommand{\poetryline}{\hspace*{\poetryindentunit}}%
        ##3%
        \end{list}%
        \end{minipage}%
        \par\vspace{8pt}%
    }%
}{%
    \end{mdframed}
    \par\vspace{10pt}%
}

% Commands for highlighting text
\newcommand{\highlightpurple}[1]{\colorbox{lightpurplebg}{\textcolor{highlightpurpletext}{#1}}}
\newcommand{\highlightgray}[1]{\colorbox{gray!30}{\textbf{#1}}}
\newcommand{\highlightbrown}[1]{\colorbox{lightbrownbg}{\textcolor{highlightbrown}{#1}}}
\newcommand{\highlightgreen}[1]{\colorbox{lightgreenbg}{\textcolor{highlightgreen}{#1}}}
\newcommand{\highlightred}[1]{\colorbox{lightredbg}{\textcolor{highlightred}{#1}}}
\newcommand{\highlightblue}[1]{\colorbox{lightbluebg}{\textcolor{highlightblue}{#1}}}
\newcommand{\highlightsilver}[1]{\colorbox{lightsilverbg}{\textcolor{highlightsilvertext}{#1}}}
\newcommand{\highlightorange}[1]{\colorbox{lightorangebg}{\textcolor{highlightorangetext}{#1}}}
\newcommand{\highlightyellow}[1]{\colorbox{lightyellowbg}{\textcolor{highlightyellowtext}{#1}}}
\newcommand{\highlightaqua}[1]{\colorbox{lightaquabg}{\textcolor{highlightaquatext}{#1}}}

% Overview environment for chapter summaries
\newenvironment{overview}[1]{%
    \par\vspace{15pt}%
    % Create the main overview box
    \begin{tikzpicture}
    \node[
        draw=black!60,
        line width=2.5pt,
        rounded corners=15pt,
        inner sep=15pt,
        text width=\linewidth-30pt,
        anchor=north west,
        top color=blue!8,
        bottom color=blue!3,
        drop shadow
    ] at (0,0) \bgroup
    \begin{minipage}{\linewidth-30pt}
    % Header with blue text on gradient background
    \vspace{-8pt}
    \textcolor{highlightblue}{\bfseries\LARGE\,#1\,}
    \vspace{12pt}
    
    % Define section command for overview items
    \newcommand{\overviewsection}[2][0]{%
        \par\vspace{10pt}
        % Create section box with proper indentation
        \hspace*{##1\dimexpr 20pt\relax}
        \begin{tikzpicture}
        \node[
            draw=black!50,
            line width=2pt,
            rounded corners=10pt,
            inner sep=12pt,
            text width=\dimexpr\linewidth-30pt-##1\dimexpr 20pt\relax-##1\dimexpr 20pt\relax,
            anchor=north west,
            top color=white,
            bottom color=blue!5,
            drop shadow={opacity=0.3}
        ] at (0,0) \bgroup
        \begin{minipage}{\dimexpr\linewidth-30pt-##1\dimexpr 20pt\relax-##1\dimexpr 20pt\relax}
        ##2
        \end{minipage}
        \egroup;
        \end{tikzpicture}
        \par
    }
    
    % Define bold section command for emphasis
    \newcommand{\overviewsectionbold}[2][0]{%
        \par\vspace{10pt}
        % Create section box with proper indentation and thicker border
        \hspace*{##1\dimexpr 20pt\relax}
        \begin{tikzpicture}
        \node[
            draw=black!70,
            line width=3.5pt,
            rounded corners=10pt,
            inner sep=12pt,
            text width=\dimexpr\linewidth-30pt-##1\dimexpr 20pt\relax-##1\dimexpr 20pt\relax,
            anchor=north west,
            top color=white,
            bottom color=blue!5,
            drop shadow={opacity=0.4}
        ] at (0,0) \bgroup
        \begin{minipage}{\dimexpr\linewidth-30pt-##1\dimexpr 20pt\relax-##1\dimexpr 20pt\relax}
        ##2
        \end{minipage}
        \egroup;
        \end{tikzpicture}
        \par
    }
}{%
    \vspace{10pt}
    \end{minipage}
    \egroup;
    \end{tikzpicture}
    \par\vspace{15pt}%
}

% Reusable Isaiah 1:2-2:21 overview with bold section parameter
% Usage: \isaiahOverview{1} where 1=bold first section, 2=bold second, 3=bold third
\newcommand{\isaiahOverview}[1]{%
    \begin{overview}{Isaiah 1:2-2:21}
    
    % Section 1: 1:2-31
    \ifnum#1=1
        \overviewsectionbold[0]{%
        \textbf{1:2-31 – Problematic Zion}
        \begin{itemize}
            \item \highlightred{Judgment} on Israel
            \item Call to repentance
        \end{itemize}
        }
    \else
        \overviewsection[0]{%
        \textbf{1:2-31 – Problematic Zion}
        \begin{itemize}
            \item \highlightred{Judgment} on Israel
            \item Call to repentance
        \end{itemize}
        }
    \fi
    
    % Section 2: 2:1-5
    \ifnum#1=2
        \overviewsectionbold[1]{%
        \textbf{2:1-5 – Future Glorious Zion}
        \begin{itemize}
            \item The mountain of the LORD exalted
            \item Nations streaming to learn God's ways
            \item Peace and instruction from Jerusalem
        \end{itemize}
        }
    \else
        \overviewsection[1]{%
        \textbf{2:1-5 – Future Glorious Zion}
        \begin{itemize}
            \item The mountain of the LORD exalted
            \item Nations streaming to learn God's ways
            \item Peace and instruction from Jerusalem
        \end{itemize}
        }
    \fi
    
    % Section 3: 2:6-22
    \ifnum#1=3
        \overviewsectionbold[0]{%
        \textbf{2:6-22 – Day of Yahweh}
        \begin{itemize}
            \item \highlightred{Judgment} on human pride and idolatry
            \item All that is high will be brought low
        \end{itemize}
        }
    \else
        \overviewsection[0]{%
        \textbf{2:6-22 – Day of Yahweh}
        \begin{itemize}
            \item \highlightred{Judgment} on human pride and idolatry
            \item All that is high will be brought low
        \end{itemize}
        }
    \fi
    
    \end{overview}
}

% Isaiah 3:1-5:30 overview with bold section parameter
% Usage: \isaiahOverviewChapters{1} where 1=bold first section, 2=bold second, 3=bold third
\newcommand{\isaiahOverviewChapters}[1]{%
    \begin{overview}{Isaiah 3:1-5:30}
    
    % Section 1: 3:1-4:1
    \ifnum#1=1
        \overviewsectionbold[0]{%
        \textbf{3:1-4:1 – Leadership Crisis}
        \begin{itemize}
            \item Yahweh's judgment and inversion of power structures
        \end{itemize}
        }
    \else
        \overviewsection[0]{%
        \textbf{3:1-4:1 – Leadership Crisis}
        \begin{itemize}
            \item Yahweh's judgment and inversion of power structures
        \end{itemize}
        }
    \fi
    
    % Section 2: 4:2-6
    \ifnum#1=2
        \overviewsectionbold[1]{%
        \textbf{4:2-6 – Future Glory}
        \begin{itemize}
            \item The Branch of the LORD will be beautiful
            \item Survivors will be holy and cleansed
            \item Divine protection over Mount Zion
        \end{itemize}
        }
    \else
        \overviewsection[1]{%
        \textbf{4:2-6 – Future Glory}
        \begin{itemize}
            \item The Branch of the LORD will be beautiful
            \item Survivors will be holy and cleansed
            \item Divine protection over Mount Zion
        \end{itemize}
        }
    \fi
    
    % Section 3: 5:1-30
    \ifnum#1=3
        \overviewsectionbold[0]{%
        \textbf{5:1-30 – Song of the Vineyard}
        \begin{itemize}
            \item Yahweh's judgment and inversion of power structures
        \end{itemize}
        }
    \else
        \overviewsection[0]{%
        \textbf{5:1-30 – Song of the Vineyard}
        \begin{itemize}
            \item Yahweh's judgment and inversion of power structures
        \end{itemize}
        }
    \fi
    
    \end{overview}
}

% Combined Isaiah 1:2-5:30 overview with bold section parameter
% Usage: \isaiahOverviewCombined{4} where 4=bold section 3:1-4:1
\newcommand{\isaiahOverviewCombined}[1]{%
    \begin{overview}{Isaiah 1:2-5:30}
    
    % Section 1: 1:2-31
    \ifnum#1=1
        \overviewsectionbold[0]{%
        \textbf{1:2-31 – Problematic Zion}
        \begin{itemize}
            \item \highlightred{Judgment} on Israel
            \item Call to repentance
        \end{itemize}
        }
    \else
        \overviewsection[0]{%
        \textbf{1:2-31 – Problematic Zion}
        \begin{itemize}
            \item \highlightred{Judgment} on Israel
            \item Call to repentance
        \end{itemize}
        }
    \fi
    
    % Section 2: 2:1-5
    \ifnum#1=2
        \overviewsectionbold[1]{%
        \textbf{2:1-5 – Future Glorious Zion}
        \begin{itemize}
            \item The mountain of the LORD exalted
            \item Nations streaming to learn God's ways
            \item Peace and instruction from Jerusalem
        \end{itemize}
        }
    \else
        \overviewsection[1]{%
        \textbf{2:1-5 – Future Glorious Zion}
        \begin{itemize}
            \item The mountain of the LORD exalted
            \item Nations streaming to learn God's ways
            \item Peace and instruction from Jerusalem
        \end{itemize}
        }
    \fi
    
    % Section 3: 2:6-22
    \ifnum#1=3
        \overviewsectionbold[0]{%
        \textbf{2:6-22 – Day of Yahweh}
        \begin{itemize}
            \item \highlightred{Judgment} on human pride and idolatry
            \item All that is high will be brought low
        \end{itemize}
        }
    \else
        \overviewsection[0]{%
        \textbf{2:6-22 – Day of Yahweh}
        \begin{itemize}
            \item \highlightred{Judgment} on human pride and idolatry
            \item All that is high will be brought low
        \end{itemize}
        }
    \fi
    
    % Section 4: 3:1-4:1
    \ifnum#1=4
        \overviewsectionbold[0]{%
        \textbf{3:1-4:1 – Leadership Crisis}
        \begin{itemize}
            \item \highlightred{Judgment} on Judah
            \item Inversion of power structures
        \end{itemize}
        }
    \else
        \overviewsection[0]{%
        \textbf{3:1-4:1 – Leadership Crisis}
        \begin{itemize}
            \item \highlightred{Judgment} on Judah
            \item Inversion of power structures
        \end{itemize}
        }
    \fi
    
    % Section 5: 4:2-6
    \ifnum#1=5
        \overviewsectionbold[1]{%
        \textbf{4:2-6 – Future Glory}
        \begin{itemize}
            \item The Branch of the LORD will be beautiful
            \item Survivors will be holy and cleansed
            \item Divine protection over Mount Zion
        \end{itemize}
        }
    \else
        \overviewsection[1]{%
        \textbf{4:2-6 – Future Glory}
        \begin{itemize}
            \item The Branch of the LORD will be beautiful
            \item Survivors will be holy and cleansed
            \item Divine protection over Mount Zion
        \end{itemize}
        }
    \fi
    
    % Section 6: 5:1-30
    \ifnum#1=6
        \overviewsectionbold[0]{%
        \textbf{5:1-30 – Song of the Vineyard}
        \begin{itemize}
            \item \highlightred{Judgment} on Judah
            \item Inversion of power structures
        \end{itemize}
        }
    \else
        \overviewsection[0]{%
        \textbf{5:1-30 – Song of the Vineyard}
        \begin{itemize}
            \item \highlightred{Judgment} on Judah
            \item Inversion of power structures
        \end{itemize}
        }
    \fi
    
    \end{overview}
}

% Bold text commands
\newcommand{\boldred}[1]{\textcolor{boldred}{\textbf{#1}}}
\newcommand{\boldblue}[1]{\textcolor{highlightblue}{\textbf{#1}}}
\newcommand{\boldgreen}[1]{\textcolor{highlightgreen}{\textbf{#1}}}
\newcommand{\boldbrown}[1]{\textcolor{highlightbrown}{\textbf{#1}}}

% Hebrew text command (moved from individual files for global use)
\RequirePackage{fontspec}
\RequirePackage{bidi}
\newfontfamily\hebrewfont{Times New Roman}[Script=Hebrew]
\newcommand{\hebrew}[1]{\bgroup\hebrewfont\RL{#1}\egroup}

% Comparison table environment for parallel passages
\newenvironment{comparisontable}[3]{%
    \par\vspace{10pt}%
    \begin{center}
    \begin{tabular}{|p{0.4\linewidth}|p{0.4\linewidth}|p{0.2\linewidth}|}
    \hline
    \textbf{#1} & \textbf{#2} & \textbf{#3} \\
    \hline
}{%
    \end{tabular}
    \end{center}
    \par\vspace{10pt}%
}

% Command for table rows with verse content
\newcommand{\verserow}[3]{%
    \begin{minipage}[t]{\linewidth}
    \vspace{2pt}
    #1
    \vspace{2pt}
    \end{minipage} & 
    \begin{minipage}[t]{\linewidth}
    \vspace{2pt}
    #2
    \vspace{2pt}
    \end{minipage} & 
    \begin{minipage}[t]{\linewidth}
    \vspace{2pt}
    #3
    \vspace{2pt}
    \end{minipage} \\
    \hline
}

\endinput